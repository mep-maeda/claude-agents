# Example 01: シンプルなUI変更

このサンプルでは、エラーダイアログにエラーコードを追加する、シンプルなUI変更の例を示します。

## 使用したプロンプト

```markdown
以下の仕様変更を実施してください。

## 変更要求

エラーダイアログのメッセージに、エラーコードを追加表示したい。

【詳細】
- 現在：エラーメッセージのみ表示
- 変更後：エラーコード（例: E001）をメッセージの前に表示
- 表示例：「[E001] ファイルが見つかりません」

## ソースコードの場所

- プロジェクト: D:\MyProject\SRC\
- エラーダイアログ: D:\MyProject\SRC\ErrorDialog.cs
- エラーコード定義: D:\MyProject\SRC\ErrorCodes.cs

## 出力ファイルの保存場所

- 分析結果: D:\MyProject\Output\Analysis\
- 変更仕様書: D:\MyProject\Output\Specs\
- テスト仕様書: D:\MyProject\Output\Tests\

## 実施手順

以下の手順で作業を進めてください。各承認ポイントで必ず私の承認を得てから次に進んでください。

### 1. 事前準備
- TodoListを作成し、全体の作業項目を管理
- 各タスクの完了時にTodoを更新

### 2. 影響範囲分析（spec-analyzer使用）
- spec-analyzerエージェントを起動
- コードベース全体への影響を分析
- 以下のファイルを生成：
  - analysis-result.json
  - analysis-summary.md
- **【承認ポイント1】** 分析結果を提示し、承認を待つ

### 3. 実装計画の作成
- 分析結果に基づいて詳細な実装計画を作成
- 優先順位、リスク、工数見積もりを含める
- **【承認ポイント2】** 実装計画を提示し、承認を待つ

### 4. 変更仕様書とフローチャート生成（spec-doc-generator使用）
- spec-doc-generatorエージェントを起動
- 分析結果（analysis-result.json）を参照
- 以下のファイルを生成：
  - SPEC_CHANGES.html（変更仕様書）
  - flowchart_No001.drawio（フローチャート）
- **【承認ポイント3】** 変更仕様書とフローチャートを提示し、承認を待つ

### 5. ソースコード変更の実装
- 承認された仕様書に基づいて実装
- 優先度の高い項目から順に実装
- 後方互換性、エラーハンドリング、リソース管理に注意

### 6. テスト仕様書の作成
- 単体テスト、統合テスト、実機テストのテストケースを作成
- **【承認ポイント4】** テスト仕様書を提示し、承認を待つ

### 7. 完了報告
- 全ての成果物を確認
- 変更内容のサマリーを報告

## 注意事項

- 各承認ポイントで必ず作業を止め、私の指示を待ってください
- 不明点や懸念事項があれば、すぐに質問してください

それでは、作業を開始してください。
```

## 生成された成果物

- `analysis-result.json` - 影響範囲分析結果
- `analysis-summary.md` - 分析サマリー
- `SPEC_CHANGES.html` - 変更仕様書（このディレクトリに含まれています）

## 実行結果サマリー

### 影響範囲

**直接影響**:
- ErrorDialog.cs（メッセージ表示ロジックの変更）
- ErrorCodes.cs（エラーコード定義の追加）

**間接影響**:
- Logger.cs（ログ出力形式の更新）

### リスク評価

**全体リスク**: 中リスク

**高リスク領域**:
- ErrorDialog.cs: 既存のエラー表示機能への影響

**中リスク領域**:
- ErrorCodes.cs: エラーコードの一意性の確保

**低リスク領域**:
- Logger.cs: ログ形式の変更のみ

### 工数見積もり

**合計**: small（1-3日）

- 設計: 0.5日
- 実装: 1日
- テスト: 1日
- デプロイ準備: 0.5日

### 実装内容

1. **ErrorCodes.cs**
   - エラーコード定義クラスを追加
   - 各エラーに対するコード（E001, E002...）を定義

2. **ErrorDialog.cs**
   - メッセージ表示ロジックを変更
   - エラーコードを含む形式で表示

3. **Logger.cs**
   - ログ出力形式を更新
   - エラーコードをログに含める

### テストケース

**単体テスト**: 5件
- ErrorCodes定義の確認
- エラーコード表示の確認
- ログ出力形式の確認

**統合テスト**: 3件
- ErrorDialogとErrorCodesの連携
- Loggerとの連携

**実機テスト**: 2件
- 実際のエラー発生時の表示確認
- ログファイルの確認

## 学習ポイント

### 1. プロンプトの書き方

✅ **良い点**:
- 変更要求が明確（現状と変更後を対比）
- ソースの場所が具体的
- 期待する成果物が明示されている

### 2. 承認ポイントの活用

各承認ポイントで確認した内容：
- **承認ポイント1**: 影響範囲が想定通りか
- **承認ポイント2**: 実装計画が現実的か
- **承認ポイント3**: 仕様書が正確か
- **承認ポイント4**: テストカバレッジが十分か

### 3. リスク軽減策

- 既存のエラー処理への影響を最小化
- エラーコードが未定義の場合のフォールバック処理
- 後方互換性の維持（既存コードでも動作）

## 応用例

このサンプルをベースに、以下のような変更にも対応できます：

1. **警告ダイアログへの拡張**
   - エラーダイアログと同じパターンを警告にも適用

2. **多言語対応**
   - エラーコードは固定、メッセージのみ多言語化

3. **ログレベルの追加**
   - エラーコードにログレベル（INFO, WARN, ERROR）を紐付け

## 次のステップ

より複雑な変更については、以下を参照：
- [example-02-complex-change](../example-02-complex-change/) - 複雑な機能追加の例
